import{Q as f}from"./QSpinnerPie.7f041fe1.js";import{h as q}from"./QItem.87f7eb07.js";import{Q as b}from"./QPagination.5f7621cf.js";import{H as w,Q as P}from"./HeaderActions.f25c2299.js";import{I as S}from"./ItemCard.0c2ebc42.js";import{G as y}from"./GeneralTable.329fea1a.js";import{_ as E,d as T,a as l,o as i,c,w as p,e as o,f as n,a7 as C,a6 as s,an as v,am as A,a9 as k,a8 as d,ao as M}from"./index.650196fd.js";import"./BtnAction.b0c7cc86.js";import"./QInput.d6ff27b1.js";import"./QChip.f7831cda.js";import"./QCard.9e15fa18.js";import"./use-fullscreen.0a2c208b.js";const _=T({name:"EquipmentsPage",components:{GeneralTable:y,HeaderActions:w,ItemCard:S},data(){return{delaySearch:300,searchModel:null,showCards:!0,switchContent:1,timeoutSearch:null,loading:!0,rowSelected:{},selectedFilterText:"category",localPagination:{totalPages:1,descending:!1,rowsPerPage:12,page:1},params:{category:""},btnAction:{show:!1,btnTitle:"Agregar equipo",iconName:"o_data_saver_on",tooltip:"Agregar nuevo equipo",to:"add-equipment"},inputSearch:{show:!0,inputLabel:"Categor\xEDa del equipo",setSelectedFilter:this.setSelectedFilter,setSelectedOptionFilter:this.setSelectedOptionFilter,heightModal:290,items:[{title:"Categor\xEDa del equipo",filter:"category",icon:"o_badge"},{title:"Ubicaci\xF3n",filter:"location",icon:"o_explore"},{title:"Modelo",filter:"model",icon:"o_alt_route"},{title:"Marca",filter:"brand",icon:"o_sell"},{title:"N\xFAmero de serie",filter:"serialNumber",icon:"o_fingerprint"},{title:"Estatus",icon:"o_supervisor_account",options:[{title:"Activo",filter:"status",value:1},{title:"Inactivo",filter:"status",value:0}]}]},columns:[{name:"equipment",label:"Equipo",align:"left",style:"white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 200px",field:"equipment",sortable:!0},{name:"model",label:"Modelo",field:"model",align:"left",sortable:!0},{name:"no_serie",label:"No. serie",field:"no_serie",align:"center",sortable:!0},{name:"badge",label:"Reportes",field:"status",align:"center",sortable:!0},{name:"actions",label:"Acciones",field:"actions",align:"center"}],actionsTable:[{icnName:"read_more",icnSize:"sm",icnAction:"Detail",tooltip:"Detalle de equipo"},{icnName:"o_edit",icnSize:"xs",icnAction:"Edit",tooltip:"Editar equipo",hidden:!0}]}},created(){this.checkPermissions(),this.getEquipments({})},watch:{rowSelected:{handler(e){e.action==="Edit"?this.goToEdit(e.id):e.action==="Detail"&&this.goToDetails(e.id)},deep:!0},searchModel(e){this.params[this.selectedFilterText]=e,clearTimeout(this.timeoutSearch),this.timeoutSearch=setTimeout(()=>{this.params.page=1,this.getEquipments(this.params)},this.delaySearch)}},computed:{equipments(){return this.$store.getters["equipments/getEquipmentsGetter"]},rows(){return this.equipments.map(e=>({id:e.id,equipment:e.cardTitle,model:e.cardLabels[0].info,no_serie:e.cardLabels[1].info,nextMaintenanceDate:e.cardDate,status:e.status}))},pagination:{get(){return this.$store.getters["equipments/getPaginationGetter"]}},userRole:{get(){return this.$store.getters["users/getRoleGetter"]}}},methods:{async getEquipments(e){this.loading=!0,await this.$store.dispatch("equipments/getEquipmentsAction",e),this.localPagination=JSON.parse(JSON.stringify(this.pagination)),this.loading=!1},async getEquipment(e){await this.$store.dispatch("equipments/getEquipmentAction",{id:e})},checkPermissions(){switch(this.userRole){case 1:this.btnAction.show=!0,this.actionsTable[1].hidden=!1;break;case 2:case 3:this.btnAction.show=!1;break}},setSelectedOptionFilter(e,t=null){e.length&&e.forEach(r=>{this.params[r.filter]=r.value}),t&&delete this.params[t],this.params.page=1,this.getEquipments(this.params)},setSelectedFilter(e){this.selectedFilterText&&(delete this.params[this.selectedFilterText],this.searchModel&&this.getEquipments(this.params)),this.selectedFilterText=e.filter,this.inputSearch.inputLabel=e.title,e.value&&e.filter&&(this.params[e.filter]=this.searchModel,this.getEquipments(this.params))},goToDetails(e){this.$router.push({name:"detail-equipment",params:{id:e}})},goToEdit(e){this.$router.push({name:"edit-equipment",params:{id:e}})},changePagination(e){this.localPagination.page=e,this.params={...this.params,page:this.localPagination.page,rowsPerPage:this.localPagination.rowsPerPage},this.getEquipments(this.params)}}}),N={class:"card-page"},F={style:{"max-width":"100%"}},$={key:0,class:"row container-cards"},D={key:1,class:"q-ma-md q-ma-sm-xl q-pa-xl text-center no-info border-rounded"},V=o("div",{class:"text-primary q-ma-lg"},"Cargando equipos",-1),Q={key:2,class:"q-ma-md q-ma-sm-xl q-pa-xl text-center no-info border-rounded"},R=o("strong",{class:"text-negative"},"!",-1),U={key:1,style:{height:"6.55%"},class:"row justify-center q-pt-sm"};function z(e,t,r,G,L,O){const h=l("header-actions"),u=l("item-card"),g=l("general-table");return i(),c(P,{class:"flex flex-center cursor-pointer non-selectable"},{default:p(()=>[o("div",N,[n(h,{titlePage:"Activos biom\xE9dicos",btnAction:e.btnAction,inputSearch:e.inputSearch,searchModel:e.searchModel,"onUpdate:searchModel":t[0]||(t[0]=a=>e.searchModel=a),"switch-content":e.switchContent,"onUpdate:switchContent":t[1]||(t[1]=a=>e.switchContent=a)},null,8,["btnAction","inputSearch","searchModel","switch-content"]),o("div",{class:C(["main-container-page q-pa-sm",{"card-color main-container-page-dark":e.switchContent===1}])},[e.switchContent===1?(i(),c(q,{key:0,style:{height:"93% !important"},class:"fit","thumb-style":e.$store.getters["global/getThumbStyle"]},{default:p(()=>[o("div",F,[e.equipments&&e.equipments.length>0?(i(),s("div",$,[(i(!0),s(v,null,A(e.equipments,(a,m)=>(i(),s("div",{class:"col-xs-12 col-sm-auto col-md-auto col-lg-auto col-xl-auto",key:m},[n(u,M(a,{status:a.isReported?{tooltip:"Tiene reporte(s) sin atender",color:"#FF9900",label:"Reportado"}:null,index:m,"card-action":e.goToDetails}),null,16,["status","index","card-action"])]))),128))])):e.loading?(i(),s("div",D,[n(f,{color:"primary",class:"q-mt-lg",size:"4em"}),V])):e.loading===!1?(i(),s("div",Q,[k(" No hay equipos para mostrar "),R])):d("",!0)])]),_:1},8,["thumb-style"])):d("",!0),e.switchContent===1&&e.equipments.length>0?(i(),s("div",U,[n(b,{modelValue:e.localPagination.page,"onUpdate:modelValue":[t[2]||(t[2]=a=>e.localPagination.page=a),e.changePagination],dense:"",class:"q-mt-none pagination-style",max:e.localPagination.totalPages,size:"md","direction-links":""},null,8,["modelValue","max","onUpdate:modelValue"])])):e.switchContent===2?(i(),c(g,{key:2,"row-selected":e.rowSelected,"onUpdate:rowSelected":t[3]||(t[3]=a=>e.rowSelected=a),height:"100%",rows:e.rows,columns:e.columns,"actions-table":e.actionsTable,"pagination-prop":e.pagination,loading:e.loading,onChangePagination:e.changePagination},null,8,["row-selected","rows","columns","actions-table","pagination-prop","loading","onChangePagination"])):d("",!0)],2)])]),_:1})}var te=E(_,[["render",z]]);export{te as default};

import{Q as f}from"./QSpinnerPie.7f041fe1.js";import{h as b}from"./QItem.87f7eb07.js";import{Q as w}from"./QPagination.5f7621cf.js";import{H as P,Q as S}from"./HeaderActions.f25c2299.js";import{I as y}from"./ItemCard.0c2ebc42.js";import{G as v}from"./GeneralTable.329fea1a.js";import{_ as C,d as T,a as l,o as s,c,w as m,e as o,f as r,a7 as A,a6 as i,an as U,am as k,a9 as F,a8 as d,ao as N}from"./index.650196fd.js";import"./BtnAction.b0c7cc86.js";import"./QInput.d6ff27b1.js";import"./QChip.f7831cda.js";import"./QCard.9e15fa18.js";import"./use-fullscreen.0a2c208b.js";const q=T({name:"UsersPage",components:{GeneralTable:v,HeaderActions:P,ItemCard:y},data(){return{delaySearch:300,searchModel:null,switchContent:1,timeoutSearch:null,loading:!0,btnCloseWindow:{iconName:"exit_to_app",btnBackground:"#FF990020",btnColor:"#FF9900",btnAction:this.goBack},localPagination:{totalPages:1,descending:!1,rowsPerPage:12,page:1},actionsTable:[{icnName:"read_more",icnSize:"sm",icnAction:"Detail",tooltip:"Detalle de usuario"},{icnName:"o_edit",icnSize:"xs",icnAction:"Edit",tooltip:"Editar usuario"}],btnAction:{show:!0,tooltip:"Agregar nuevo usuario",btnTitle:"Agregar usuario",to:"add-user"},columns:[{name:"user",required:!0,label:"Nombre",align:"left",field:e=>e.user,format:e=>`${e}`,sortable:!0},{name:"carrer",label:"Puesto",field:"carrer",align:"left",sortable:!0},{name:"role",label:"Rol",field:"role",align:"center",sortable:!0},{name:"badge",label:"Estatus",field:"status",align:"center",sortable:!0},{name:"actions",label:"Acciones",field:"actions",align:"center"}],inputSearch:{show:!0,inputLabel:"Nombre de usuario",setSelectedFilter:this.setSelectedFilter,setSelectedOptionFilter:this.setSelectedOptionFilter,heightModal:160,items:[{title:"Nombre de usuario",icon:"o_account_circle",filter:"name"},{title:"Role",icon:"o_low_priority",options:[{title:"Administrador",filter:"role",value:1},{title:"Auxiliar",filter:"role",value:2},{title:"Expectador",filter:"role",value:3}]},{title:"Estatus",icon:"o_supervisor_account",options:[{title:"Activo",filter:"status",value:1},{title:"Inactivo",filter:"status",value:0}]}]},params:{name:""},rowSelected:{},selectedFilterText:"name"}},created(){this.getUsers({})},watch:{rowSelected:{handler(e){e.action==="Edit"?this.goToEdit(e.id):e.action==="Detail"&&this.goToDetails(e.id)},deep:!0},searchModel(e){this.params[this.selectedFilterText]=e,clearTimeout(this.timeoutSearch),this.timeoutSearch=setTimeout(()=>{this.params.page=1,this.getUsers(this.params)},this.delaySearch)},selectedFilterText(){this.params.page=1}},computed:{users:{get(){return this.$store.getters["users/getUsersGetter"]}},pagination:{get(){return this.$store.getters["users/getPaginationGetter"]}},rows(){return this.users.map(e=>({id:e.id,user:e.cardTitle,carrer:e.cardLabels[0].label,role:e.cardLabels[0].info,status:e.status}))}},methods:{async getUsers(e){this.loading=!0,await this.$store.dispatch("users/getUsersAction",e),this.localPagination=JSON.parse(JSON.stringify(this.pagination)),this.loading=!1},goBack(){this.$router.go(-1)},goToDetails(e){this.$router.push({name:"detail-user",params:{id:e}})},goToEdit(e){this.$router.push({name:"edit-user",params:{id:e}})},setSelectedFilter(e){this.selectedFilterText&&(delete this.params[this.selectedFilterText],this.searchModel&&this.getUsers(this.params)),this.selectedFilterText=e.filter,this.inputSearch.inputLabel=e.title,e.value&&e.filter&&(this.params[e.filter]=this.searchModel,this.getUsers(this.params))},setSelectedOptionFilter(e,t=null){e.length&&e.forEach(n=>{this.params[n.filter]=n.value}),t&&delete this.params[t],this.params.page=1,this.getUsers(this.params)},changePagination(e){this.localPagination.page=e,this.params={...this.params,page:this.localPagination.page,rowsPerPage:this.localPagination.rowsPerPage},this.getUsers(this.params)}}}),$={class:"card-page"},E={style:{"max-width":"100%"}},M={key:0,class:"row container-cards"},V={key:1,class:"q-ma-md q-ma-sm-xl q-pa-xl text-center no-info border-rounded"},_=o("div",{class:"text-primary q-ma-lg"},"Cargando usuarios",-1),B={key:2,class:"q-ma-md q-ma-sm-xl q-pa-xl text-center no-info border-rounded"},Q=o("strong",{class:"text-negative"},"!",-1),D={key:1,style:{height:"6.55%"},class:"row justify-center q-pt-sm"};function z(e,t,n,L,O,G){const h=l("header-actions"),g=l("item-card"),p=l("general-table");return s(),c(S,{class:"flex flex-center cursor-pointer non-selectable"},{default:m(()=>[o("div",$,[r(h,{titlePage:"Usuarios",btnAction:e.btnAction,"btn-close-window":e.btnCloseWindow,inputSearch:e.inputSearch,searchModel:e.searchModel,"onUpdate:searchModel":t[0]||(t[0]=a=>e.searchModel=a),"switch-content":e.switchContent,"onUpdate:switchContent":t[1]||(t[1]=a=>e.switchContent=a)},null,8,["btnAction","btn-close-window","inputSearch","searchModel","switch-content"]),o("div",{class:A(["main-container-page q-pa-sm",{"card-color main-container-page-dark":e.switchContent===1}])},[e.switchContent===1?(s(),c(b,{key:0,style:{height:"93% !important"},class:"fit","thumb-style":e.$store.getters["global/getThumbStyle"]},{default:m(()=>[o("div",E,[e.users.length>0?(s(),i("div",M,[(s(!0),i(U,null,k(e.users,(a,u)=>(s(),i("div",{key:u,class:"col-xs-12 col-sm-auto col-md-auto col-lg-auto col-xl-auto"},[r(g,N(a,{index:u,status:a.status===!1?{tooltip:"El usuario est\xE1 inactivo",color:"#dc4e5f",label:"Inactivo"}:null,"card-action":e.goToDetails}),null,16,["index","status","card-action"])]))),128))])):e.loading?(s(),i("div",V,[r(f,{color:"primary",class:"q-mt-lg",size:"4em"}),_])):e.loading===!1?(s(),i("div",B,[F(" No hay usuarios para mostrar "),Q])):d("",!0)])]),_:1},8,["thumb-style"])):d("",!0),e.switchContent===1&&e.users.length>0?(s(),i("div",D,[r(w,{modelValue:e.localPagination.page,"onUpdate:modelValue":[t[2]||(t[2]=a=>e.localPagination.page=a),e.changePagination],dense:"",class:"q-mt-none pagination-style",max:e.localPagination.totalPages,size:"md","direction-links":""},null,8,["modelValue","max","onUpdate:modelValue"])])):e.switchContent===2?(s(),c(p,{key:2,"row-selected":e.rowSelected,"onUpdate:rowSelected":t[3]||(t[3]=a=>e.rowSelected=a),height:"100%",rows:e.rows,columns:e.columns,"actions-table":e.actionsTable,"pagination-prop":e.pagination,loading:e.loading,onChangePagination:e.changePagination},null,8,["row-selected","rows","columns","actions-table","pagination-prop","loading","onChangePagination"])):d("",!0)],2)])]),_:1})}var te=C(q,[["render",z]]);export{te as default};
